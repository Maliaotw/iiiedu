# IIIEDU - æ•¸æ“šåˆ†æèˆ‡èª²ç¨‹ç®¡ç†å¹³å°

æœ¬å°ˆæ¡ˆæ˜¯ä¸€å€‹åŸºæ–¼ Django çš„æ•™è‚²æ•¸æ“šåˆ†æèˆ‡èª²ç¨‹ç®¡ç†å¹³å°ï¼Œæ—¨åœ¨è‡ªå‹•åŒ–è™•ç†èª²ç¨‹æ•¸æ“šï¼ˆå¦‚è³‡ç­–æœƒèª²ç¨‹ï¼‰ï¼Œä¸¦é€é Highcharts æä¾›ç›´è§€çš„è¦–è¦ºåŒ–åˆ†æåœ–è¡¨ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

*   **æ•¸æ“šè‡ªå‹•åŒ–å°å…¥**ï¼šæ”¯æ´å¾ Excel (`.xlsx`) æª”æ¡ˆè‡ªå‹•å°å…¥èª²ç¨‹è³‡æ–™è‡³ PostgreSQL è³‡æ–™åº«ã€‚
*   **æ•¸æ“šåˆ†æèˆ‡å¿«å–**ï¼šé€é `ingest_data` æŒ‡ä»¤é€²è¡Œæ•¸æ“šæ¸…æ´—ã€åˆ†æï¼Œä¸¦ç”Ÿæˆ `chart_data.json` ä¾›å‰ç«¯åœ–è¡¨å³æ™‚èª¿ç”¨ã€‚
*   **è¦–è¦ºåŒ–åœ–è¡¨**ï¼šæ•´åˆ Highchartsï¼Œå±•ç¤ºç†±é–€èª²ç¨‹ã€æœˆä»½åˆ†ä½ˆã€èªè­‰çµ±è¨ˆç­‰è¶¨å‹¢åœ–ã€‚
*   **èª²ç¨‹ç®¡ç†ç³»çµ±**ï¼š
    *   èª²ç¨‹æœå°‹èˆ‡åˆ†é ã€‚
    *   æ¨™ç±¤åŒ–åˆ†é¡ï¼ˆèªè­‰ã€å°ˆæ¥­èª²ç¨‹ã€é¤Šæˆç­ï¼‰ã€‚
    *   æ ¡å€èˆ‡é ˜åŸŸ (Series) é—œè¯æŸ¥è©¢ã€‚
*   **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šå®Œæ•´çš„ Dockerfile èˆ‡ Docker-compose é…ç½®ï¼Œæ”¯æ´ NAS èˆ‡ä¼ºæœå™¨å¿«é€Ÿéƒ¨ç½²ã€‚

## ğŸ› ï¸ æŠ€è¡“æ£§

*   **Backend**: Python 3.12, Django, Pandas, Django REST Framework.
*   **Package Manager**: `uv` (Astral).
*   **Frontend**: Semantic UI, Highcharts, jQuery.
*   **Database**: PostgreSQL.
*   **Server**: uWSGI (æ•´åˆéœæ…‹æª”æ¡ˆç®¡ç†).

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```text
â”œâ”€â”€ apps/iiiedu/          # Django App (æ ¸å¿ƒæ¥­å‹™é‚è¼¯)
â”‚   â”œâ”€â”€ management/      # è‡ªå®šç¾©æŒ‡ä»¤ (æ•¸æ“šå°å…¥èˆ‡åˆ†æ)
â”‚   â”œâ”€â”€ models.py        # èª²ç¨‹ã€æ¨™ç±¤ã€æ ¡å€ç­‰è³‡æ–™æ¨¡å‹
â”‚   â””â”€â”€ views.py         # åœ–è¡¨èˆ‡èª²ç¨‹å±•ç¤ºè¦–åœ–
â”œâ”€â”€ config/              # Django å°ˆæ¡ˆå…¨åŸŸé…ç½®
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/             # åŸå§‹ Excel æ•¸æ“šå­˜æ”¾è™• (å·² GitIgnore)
â”‚   â””â”€â”€ static/          # ç”Ÿç”¢ç’°å¢ƒéœæ…‹æª”æ¡ˆ
â”œâ”€â”€ static/              # å‰ç«¯è³‡æº (JS, CSS, Themes, Chart JSON)
â””â”€â”€ templates/           # HTML æ¨¡æ¿
```

## âš™ï¸ æœ¬åœ°é–‹ç™¼ç’°å¢ƒè¨­å®š

### 1. å®‰è£ `uv` èˆ‡ä¾è³´

æœ¬å°ˆæ¡ˆå»ºè­°ä½¿ç”¨ `uv` é€²è¡Œå¿«é€Ÿé–‹ç™¼ï¼š

```bash
# å®‰è£ä¾è³´ä¸¦å»ºç«‹è™›æ“¬ç’°å¢ƒ
uv sync
```

### 2. ç’°å¢ƒè®Šæ•¸é…ç½®

è«‹åƒè€ƒ `.env.example` å»ºç«‹è‡ªå·±çš„ `.env` æª”æ¡ˆï¼š

```bash
cp .env.example .env
# è«‹ç·¨è¼¯ .env å¡«å…¥æ­£ç¢ºçš„ DJANGO_SECRET_KEY èˆ‡ DATABASE_URL
```

### 3. æ•¸æ“šå°å…¥èˆ‡åˆ†æ

å°‡æ‚¨çš„æ•¸æ“šæ”¾å…¥ `data/raw/iiiedu.xlsx`ï¼Œç„¶å¾ŒåŸ·è¡Œï¼š

```bash
# åŸ·è¡Œé·ç§»
uv run manage.py migrate

# å°å…¥æ•¸æ“šä¸¦æ›´æ–°åœ–è¡¨åˆ†æçµæœ
uv run manage.py ingest_data
```

### 4. å•Ÿå‹•ä¼ºæœå™¨

```bash
uv run manage.py runserver
```

## ğŸ³ Docker / NAS éƒ¨ç½²

æˆ‘å€‘æä¾›äº†å°ˆç‚º NAS (æˆ–ä¼ºæœå™¨) å„ªåŒ–çš„é…ç½®ã€‚

### 1. æ§‹å»ºèˆ‡æ¨é€æ˜ åƒæª”

åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤é€²è¡Œç‰ˆæœ¬æ›´æ–°ä¸¦æ¨é€åˆ° NAS ç§æœ‰å€‰åº«ï¼š

```bash
# æ§‹å»ºæœ€æ–°ç‰ˆæœ¬ (è«‹æ ¹æ“š pyproject.toml èª¿æ•´ç‰ˆæœ¬è™Ÿ)
docker build --no-cache -t 192.168.68.56:5050/iiiedu:v0.1.3 -t 192.168.68.56:5050/iiiedu:latest .

# æ¨é€åˆ° NAS å€‰åº«
docker push 192.168.68.56:5050/iiiedu:v0.1.3
docker push 192.168.68.56:5050/iiiedu:latest
```

### 2. å•Ÿå‹•æœå‹™

ä½¿ç”¨ç”Ÿç”¢ç’°å¢ƒé…ç½®å•Ÿå‹•ï¼š

```bash
docker-compose -f docker-compose-nas.yml up -d
```

å•Ÿå‹•å¾Œï¼Œæœå‹™æœƒè‡ªå‹•ï¼š
1. åŸ·è¡Œ `collectstatic` æ”¶é›†éœæ…‹æª”æ¡ˆã€‚
2. é€é `uWSGI` çš„ `static-map` æ•´åˆéœæ…‹è³‡æºèˆ‡ Django æœå‹™æ–¼ `8001` åŸ å•Ÿå‹•ã€‚

## ğŸ™ GitHub ç‰ˆæœ¬æ§åˆ¶

æœ¬å°ˆæ¡ˆå·²åŒæ­¥è‡³ GitHubï¼š[Maliaotw/iiiedu](https://github.com/Maliaotw/iiiedu.git)

*   **ä¸»åˆ†æ”¯**: `main`
*   **æäº¤è®Šæ›´**:
    ```bash
    git add .
    git commit -m "Your description"
    git push origin main
    ```

## ğŸ”’ å®‰å…¨æ€§èªªæ˜

*   `.env` åŒ…å«æ•æ„Ÿé‡‘é‘°èˆ‡è³‡æ–™åº«å¯†ç¢¼ï¼Œå·²æ’é™¤æ–¼ Git è¿½è¹¤ä¹‹å¤–ã€‚
*   Django Admin ä»‹é¢å·²åœç”¨ä»¥ç°¡åŒ–ç³»çµ±ã€‚
*   å»ºè­°åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­é—œé–‰ `DEBUG=False` ä¸¦è¨­ç½®æ­£ç¢ºçš„ `ALLOWED_HOSTS`ã€‚
